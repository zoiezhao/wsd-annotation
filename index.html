<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>è¯ä¹‰æ ‡æ³¨ä»»åŠ¡</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            max-width: 1400px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
            font-size: 16px;
        }
        
        /* ç™»å½•ç•Œé¢æ ·å¼ */
        #login-container {
            max-width: 500px;
            margin: 100px auto;
            background-color: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        #login-container h1 {
            color: #2c3e50;
            margin-bottom: 30px;
        }
        
        #login-container input {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            margin-bottom: 20px;
            box-sizing: border-box;
        }
        
        #login-container button {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            background-color: #2196F3;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        #login-container button:hover {
            background-color: #1976D2;
        }
        
        #login-error {
            color: red;
            margin-top: 10px;
            display: none;
        }
        
        /* ä¸»ç•Œé¢æ ·å¼ */
        #main-container {
            display: none;
        }
        
        #question-container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-family: 'Trebuchet MS', sans-serif;
        }
        
        h2 {
            font-family: 'Trebuchet MS', sans-serif;
            font-size: 22px;
            color: #2c3e50;
        }
        
        .user-info {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .user-info-left {
            font-weight: 600;
            color: #1565c0;
        }
        
        .user-info-right {
            color: #666;
        }
        
        .logout-btn {
            background-color: #757575 !important;
            padding: 8px 20px !important;
            font-size: 14px !important;
            margin-left: 15px;
        }
        
        /* é€‰é¡¹å®¹å™¨ - ä¸¤åˆ—å¸ƒå±€ */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        label {
            display: block;
            padding: 18px;
            background-color: #ffffff;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        label:hover {
            background-color: #f0f8ff;
            border-color: #2196F3;
            box-shadow: 0 2px 8px rgba(33, 150, 243, 0.15);
        }
        
        /* ä»£ç å—æ ·å¼ */
        .logic-code {
            background-color: #fafafa;
            color: #1a1a1a;
            padding: 14px;
            border-radius: 6px;
            border-left: 4px solid #2196F3;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            margin: 10px 0;
            white-space: pre;
            overflow-x: auto;
            line-height: 1.6;
        }
        
        /* æ ‡ç­¾æ ·å¼ */
        .frame-label {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 700;
            margin-top: 8px;
        }
        
        .option-number {
            font-size: 15px;
            font-weight: normal;
            color: #666;
            margin-bottom: 5px;
            display: block;
        }
        
        /* æŠ˜å é¢æ¿æ ·å¼ */
        .fn-group {
            margin-bottom: 20px;
        }
        
        .fn-header {
            padding: 12px 18px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
            margin-bottom: 10px;
        }
        
        .fn-header:hover {
            opacity: 0.9;
            transform: translateX(2px);
        }
        
        .fn-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .fn-icon {
            font-size: 12px;
            transition: transform 0.2s;
        }
        
        .fn-icon.collapsed {
            transform: rotate(-90deg);
        }
        
        .fn-count {
            font-size: 13px;
            opacity: 0.8;
        }
        
        .fn-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .fn-options.collapsed {
            display: none;
        }
        
        input[type="radio"] {
            transform: scale(1.3);
            margin-right: 10px;
        }
        
        button {
            background-color: #2196F3;
            color: white;
            padding: 14px 35px;
            font-size: 17px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 10px;
        }
        
        button:hover {
            background-color: #1976D2;
        }
        
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        
        .progress {
            color: #666;
            margin-bottom: 20px;
            font-size: 16px;
            font-weight: 600;
        }
        
        /* æµ®çª—æ ·å¼ */
        #selected-panel {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: white;
            border: 2px solid #2196F3;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            display: none;
        }
        
        #selected-panel.show {
            display: block;
        }
        
        .panel-header {
            background-color: #2196F3;
            color: white;
            padding: 12px 15px;
            border-radius: 6px 6px 0 0;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
        }
        
        .panel-header:hover {
            background-color: #1976D2;
        }
        
        .panel-content {
            padding: 15px;
            max-width: 500px;
            max-height: 400px;
            overflow-y: auto;
            display: none;
        }
        
        .panel-content.expanded {
            display: block;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 18px;
            color: #666;
        }
        
        .saving-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            display: none;
            z-index: 2000;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <!-- ç™»å½•ç•Œé¢ -->
    <div id="login-container">
        <h1>è¯ä¹‰æ¶ˆæ­§æ ‡æ³¨ç³»ç»Ÿ</h1>
        <p>è¯·è¾“å…¥æ‚¨çš„æ ‡æ³¨å‘˜ID</p>
        <input type="text" id="annotator-id-input" placeholder="ä¾‹å¦‚ï¼šannotator1" />
        <button onclick="login()">å¼€å§‹æ ‡æ³¨</button>
        <div id="login-error">è¯·è¾“å…¥æœ‰æ•ˆçš„æ ‡æ³¨å‘˜ID</div>
    </div>
    
    <!-- ä¸»ç•Œé¢ -->
    <div id="main-container">
        <h1>è¯ä¹‰æ¶ˆæ­§æ ‡æ³¨</h1>
        
        <div class="user-info">
            <div class="user-info-left">
                <span id="user-name"></span>
                <button class="logout-btn" onclick="logout()">é€€å‡ºç™»å½•</button>
            </div>
            <div class="user-info-right">
                <span id="progress-info"></span>
                <button class="logout-btn" onclick="manualSave()" id="manual-save-btn" style="background-color: #FF9800; margin-left: 15px;">ğŸ’¾ ç¡®è®¤ä¿å­˜</button>
            </div>
        </div>
        
        <div class="progress" id="progress"></div>
        
        <div id="question-container">
            <div class="loading">Loading questions...</div>
        </div>
        
        <br>
        <button onclick="previousQuestion()" id="prev-btn" style="background-color: #757575;">â† ä¸Šä¸€é¢˜</button>
        <button onclick="submitAnswer()" id="next-btn">ä¸‹ä¸€é¢˜ â†’</button>
        <button onclick="manualSave()" id="save-btn" style="background-color: #FF9800;">ğŸ’¾ ä¿å­˜è¿›åº¦</button>
        
        <!-- æµ®çª— -->
        <div id="selected-panel">
            <div class="panel-header" onclick="togglePanel()">
                <span id="panel-title">âœ“ No selection</span>
            </div>
            <div class="panel-content" id="panel-content"></div>
        </div>
        
        <!-- ä¿å­˜æç¤º -->
        <div class="saving-indicator" id="saving-indicator">âœ“ å·²ä¿å­˜</div>
    </div>
    
    <script>
        // Google Apps Script Web App URL
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwnLzjIgJOvg_b--J5FqDnIFLr8BiREYfTGXFOi2V_2cO_91eAo22lkeqfaQkb2IDLJ/exec';
        
        // é¢œè‰²æ–¹æ¡ˆ
        const colorSchemes = [
            { bg: '#e3f2fd', text: '#1565c0' },
            { bg: '#fff3e0', text: '#e65100' },
            { bg: '#e8f5e9', text: '#2e7d32' },
            { bg: '#f3e5f5', text: '#6a1b9a' },
            { bg: '#fff9c4', text: '#f57f17' },
            { bg: '#e0f2f1', text: '#00695c' },
            { bg: '#fce4ec', text: '#c2185b' },
            { bg: '#f1f8e9', text: '#558b2f' }
        ];
        
        let fnColorMap = {};
        let questions = [];
        let currentQuestion = 0;
        let answers = {};  // æ”¹ä¸ºå¯¹è±¡ï¼Œkeyæ˜¯question_index
        let currentAnnotator = null;
        let saveQueue = [];  // ä¿å­˜é˜Ÿåˆ—
        let isSaving = false;
        
        // ç™»å½•
        function login() {
            const annotatorId = document.getElementById('annotator-id-input').value.trim();
            
            if (!annotatorId) {
                document.getElementById('login-error').style.display = 'block';
                return;
            }
            
            currentAnnotator = annotatorId;
            document.getElementById('login-container').style.display = 'none';
            document.getElementById('main-container').style.display = 'block';
            document.getElementById('user-name').textContent = 'æ ‡æ³¨å‘˜: ' + annotatorId;
            
            // åŠ è½½é¢˜ç›®å’Œè¿›åº¦
            loadQuestionsAndProgress();
        }
        
        // é€€å‡ºç™»å½•
        function logout() {
            if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿæ‚¨çš„è¿›åº¦å·²è‡ªåŠ¨ä¿å­˜ã€‚')) {
                // ç­‰å¾…æ‰€æœ‰ä¿å­˜å®Œæˆ
                processSaveQueue().then(() => {
                    currentAnnotator = null;
                    answers = {};
                    currentQuestion = 0;
                    saveQueue = [];
                    document.getElementById('login-container').style.display = 'block';
                    document.getElementById('main-container').style.display = 'none';
                    document.getElementById('annotator-id-input').value = '';
                });
            }
        }
        
        // åŠ è½½é¢˜ç›®å’Œè¿›åº¦
        async function loadQuestionsAndProgress() {
            try {
                // åŠ è½½é¢˜ç›®
                const questionsResponse = await fetch('questions.json');
                questions = await questionsResponse.json();
                console.log('Loaded ' + questions.length + ' questions');
                
                // åŠ è½½è¯¥ç”¨æˆ·çš„è¿›åº¦
                const progressResponse = await fetch(SCRIPT_URL + '?action=getProgress&annotator_id=' + currentAnnotator);
                const progressData = await progressResponse.json();
                
                if (progressData.success) {
                    // æ„å»ºanswerså¯¹è±¡
                    progressData.answered.forEach(item => {
                        answers[item.question_index] = item.selected_answer;
                    });
                    
                    // æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœªå›ç­”çš„é¢˜ç›®
                    currentQuestion = 0;
                    for (let i = 0; i < questions.length; i++) {
                        if (!(i in answers)) {
                            currentQuestion = i;
                            break;
                        }
                    }
                    
                    // å¦‚æœå…¨éƒ¨å®Œæˆ
                    if (currentQuestion === 0 && Object.keys(answers).length === questions.length) {
                        currentQuestion = questions.length - 1;
                    }
                    
                    console.log('Loaded progress: ' + Object.keys(answers).length + ' answered, starting at question ' + (currentQuestion + 1));
                }
                
                updateProgressInfo();
                displayQuestion();
                
            } catch (error) {
                console.error('Error loading:', error);
                document.getElementById('question-container').innerHTML = 
                    '<div class="loading" style="color: red;">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•</div>';
            }
        }
        
        // æ›´æ–°è¿›åº¦ä¿¡æ¯
        function updateProgressInfo() {
            const completed = Object.keys(answers).length;
            const total = questions.length;
            document.getElementById('progress-info').textContent = 
                `å·²å®Œæˆ: ${completed}/${total} é¢˜ (${Math.round(completed/total*100)}%)`;
        }
        
        // ä¿å­˜ç­”æ¡ˆåˆ°Google Sheetsï¼ˆå¼‚æ­¥ï¼Œä¸ç­‰å¾…ï¼‰
        function saveAnswer(questionIndex, selectedAnswer) {
            // æ·»åŠ åˆ°ä¿å­˜é˜Ÿåˆ—
            saveQueue.push({
                questionIndex: questionIndex,
                selectedAnswer: selectedAnswer
            });
            
            // è§¦å‘ä¿å­˜å¤„ç†
            processSaveQueue();
        }
        
        // å¤„ç†ä¿å­˜é˜Ÿåˆ—
        async function processSaveQueue() {
            if (isSaving || saveQueue.length === 0) {
                return;
            }
            
            isSaving = true;
            const indicator = document.getElementById('saving-indicator');
            
            while (saveQueue.length > 0) {
                const item = saveQueue.shift();
                
                try {
                    const formData = new URLSearchParams();
                    formData.append('action', 'saveAnswer');
                    formData.append('annotator_id', currentAnnotator);
                    formData.append('question_index', item.questionIndex);
                    formData.append('selected_answer', item.selectedAnswer);
                    
                    await fetch(SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: formData
                    });
                    
                    // æ˜¾ç¤ºä¿å­˜æˆåŠŸæç¤º
                    indicator.style.display = 'block';
                    setTimeout(() => {
                        indicator.style.display = 'none';
                    }, 1000);
                    
                } catch (error) {
                    console.error('Error saving answer:', error);
                    // ä¿å­˜å¤±è´¥ï¼Œé‡æ–°åŠ å…¥é˜Ÿåˆ—
                    saveQueue.unshift(item);
                    break;
                }
            }
            
            isSaving = false;
        }

        // æ‰‹åŠ¨ä¿å­˜
        async function manualSave() {
            const saveBtn = document.getElementById('save-btn');
            const originalText = saveBtn.innerHTML;
            
            // ç¦ç”¨æŒ‰é’®ï¼Œæ˜¾ç¤ºä¿å­˜ä¸­
            saveBtn.disabled = true;
            saveBtn.innerHTML = 'ä¿å­˜ä¸­...';
            saveBtn.style.backgroundColor = '#999';
            
            try {
                // å¤„ç†æ‰€æœ‰å¾…ä¿å­˜çš„æ•°æ®
                await processSaveQueue();
                
                // æ˜¾ç¤ºæˆåŠŸ
                saveBtn.innerHTML = 'âœ“ ä¿å­˜æˆåŠŸ';
                saveBtn.style.backgroundColor = '#4CAF50';
                
                // 2ç§’åæ¢å¤
                setTimeout(() => {
                    saveBtn.disabled = false;
                    saveBtn.innerHTML = originalText;
                    saveBtn.style.backgroundColor = '#FF9800';
                }, 2000);
                
            } catch (error) {
                console.error('Manual save error:', error);
                saveBtn.innerHTML = 'âœ— ä¿å­˜å¤±è´¥';
                saveBtn.style.backgroundColor = '#f44336';
                
                setTimeout(() => {
                    saveBtn.disabled = false;
                    saveBtn.innerHTML = originalText;
                    saveBtn.style.backgroundColor = '#FF9800';
                }, 2000);
            }
        }
        
        // ä¸ºFNæ ‡ç­¾åˆ†é…é¢œè‰²
        function assignFNColors(definitions) {
            const uniqueFNs = [...new Set(definitions.map(d => d.label))];
            uniqueFNs.forEach((fn, index) => {
                if (!fnColorMap[fn]) {
                    const color = colorSchemes[index % colorSchemes.length];
                    fnColorMap[fn] = color;
                }
            });
        }
        
        // æ˜¾ç¤ºé¢˜ç›®
        function displayQuestion() {
            if (questions.length === 0) {
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦å…¨éƒ¨å®Œæˆ
            if (Object.keys(answers).length === questions.length) {
                showAllCompleted();
                return;
            }
            
            const q = questions[currentQuestion];
            fnColorMap = {};
            assignFNColors(q.definitions);
            
            const sortedDefs = q.definitions.map((def, originalIndex) => ({
                ...def,
                originalIndex: originalIndex
            })).sort((a, b) => a.label.localeCompare(b.label));
            
            const fnGroups = {};
            sortedDefs.forEach(def => {
                if (!fnGroups[def.label]) {
                    fnGroups[def.label] = [];
                }
                fnGroups[def.label].push(def);
            });
            
            let html = `
                <h2>Sentence: "${q.sentence}"</h2>
                <p>Which interpretation of the word "<strong>${q.word}</strong>" is the most appropriate?</p>
            `;
            
            let displayIndex = 0;
            Object.keys(fnGroups).forEach(fnLabel => {
                const color = fnColorMap[fnLabel];
                const options = fnGroups[fnLabel];
                
                html += `
                    <div class="fn-group">
                        <div class="fn-header" style="background-color: ${color.bg}; color: ${color.text};" onclick="toggleFNGroup('${fnLabel}')">
                            <div class="fn-title">
                                <span class="fn-icon" id="icon-${fnLabel}">â–¼</span>
                                <span>${fnLabel}</span>
                            </div>
                            <span class="fn-count">(${options.length} option${options.length > 1 ? 's' : ''})</span>
                        </div>
                        <div class="fn-options" id="options-${fnLabel}">
                `;
                
                options.forEach(def => {
                    html += `
                        <label>
                            <input type="radio" name="answer" value="${def.originalIndex}">
                            <span class="option-number" style="display: inline;">Option ${displayIndex + 1}:</span>
                            <div class="logic-code">${def.code}</div>
                            <span class="frame-label" style="background-color: ${color.bg}; color: ${color.text};">${def.label}</span>
                        </label>
                    `;
                    displayIndex++;
                });
                
                html += `
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('question-container').innerHTML = html;
            document.getElementById('progress').innerHTML = `Question ${currentQuestion + 1} of ${questions.length}`;
            
            // æ¢å¤ä¹‹å‰çš„é€‰æ‹©ï¼ˆå¦‚æœæœ‰ï¼‰
            if (currentQuestion in answers) {
                const savedAnswer = answers[currentQuestion];
                const radio = document.querySelector(`input[name="answer"][value="${savedAnswer}"]`);
                if (radio) {
                    radio.checked = true;
                    updateSelectedPanel();
                }
            }
            
            document.querySelectorAll('input[name="answer"]').forEach(radio => {
                radio.addEventListener('change', updateSelectedPanel);
            });
            
            const prevBtn = document.getElementById('prev-btn');
            if (currentQuestion === 0) {
                prevBtn.style.display = 'none';
            } else {
                prevBtn.style.display = 'inline-block';
            }
        }
        
        // æäº¤ç­”æ¡ˆ
        function submitAnswer() {
            const selected = document.querySelector('input[name="answer"]:checked');
            
            if (!selected) {
                alert('Please select an answer first!');
                return;
            }
            
            const selectedAnswer = parseInt(selected.value);
            
            // ä¿å­˜ç­”æ¡ˆï¼ˆå¼‚æ­¥ï¼Œä¸ç­‰å¾…ï¼‰
            answers[currentQuestion] = selectedAnswer;
            saveAnswer(currentQuestion, selectedAnswer);
            updateProgressInfo();
            
            // ç«‹å³è·³è½¬åˆ°ä¸‹ä¸€é¢˜
            currentQuestion++;
            
            // è·³è¿‡å·²å›ç­”çš„é¢˜
            while (currentQuestion < questions.length && currentQuestion in answers) {
                currentQuestion++;
            }
            
            if (currentQuestion < questions.length) {
                displayQuestion();
                window.scrollTo(0, 0);
                document.getElementById('selected-panel').classList.remove('show');
                document.getElementById('panel-content').classList.remove('expanded');
            } else {
                showAllCompleted();
            }
        }
        
        // ä¸Šä¸€é¢˜
        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                displayQuestion();
                window.scrollTo(0, 0);
            }
        }
        
        // æ˜¾ç¤ºå…¨éƒ¨å®Œæˆ
        function showAllCompleted() {
            let html = '<h2>ğŸ‰ æ­å–œï¼æ‚¨å·²å®Œæˆæ‰€æœ‰æ ‡æ³¨ä»»åŠ¡ï¼</h2>';
            html += `<p>æ€»å…±å®Œæˆï¼š${questions.length} é¢˜</p>`;
            html += '<p>æ„Ÿè°¢æ‚¨çš„è´¡çŒ®ï¼æ‚¨å¯ä»¥å®‰å…¨åœ°å…³é—­æ­¤é¡µé¢ã€‚</p>';
            
            document.getElementById('question-container').innerHTML = html;
            document.getElementById('progress').innerHTML = '';
            document.getElementById('prev-btn').style.display = 'none';
            document.getElementById('next-btn').style.display = 'none';
        }
        
        // æ›´æ–°æµ®çª—å†…å®¹
        function updateSelectedPanel() {
            const selected = document.querySelector('input[name="answer"]:checked');
            const panel = document.getElementById('selected-panel');
            
            if (!selected) {
                panel.classList.remove('show');
                return;
            }
            
            const index = parseInt(selected.value);
            const def = questions[currentQuestion].definitions[index];
            
            const sortedDefs = questions[currentQuestion].definitions.map((def, originalIndex) => ({
                ...def,
                originalIndex: originalIndex
            })).sort((a, b) => a.label.localeCompare(b.label));
            
            const displayIndex = sortedDefs.findIndex(d => d.originalIndex === index);
            
            document.getElementById('panel-title').textContent = `âœ“ Option ${displayIndex + 1} selected (click to view)`;
            
            const color = fnColorMap[def.label];
            document.getElementById('panel-content').innerHTML = `
                <div class="logic-code">${def.code}</div>
                <span class="frame-label" style="background-color: ${color.bg}; color: ${color.text};">${def.label}</span>
            `;
            
            panel.classList.add('show');
        }
        
        // åˆ‡æ¢æµ®çª—å±•å¼€/æ”¶èµ·
        function togglePanel() {
            const content = document.getElementById('panel-content');
            content.classList.toggle('expanded');
        }
        
        // åˆ‡æ¢FNç»„çš„å±•å¼€/æ”¶èµ·
        function toggleFNGroup(fnLabel) {
            const options = document.getElementById('options-' + fnLabel);
            const icon = document.getElementById('icon-' + fnLabel);
            
            options.classList.toggle('collapsed');
            icon.classList.toggle('collapsed');
        }
        
        // é¡µé¢å…³é—­å‰ç¡®ä¿ä¿å­˜å®Œæˆ
        window.addEventListener('beforeunload', function (e) {
            if (saveQueue.length > 0) {
                e.preventDefault();
                e.returnValue = 'è¿˜æœ‰æ•°æ®æ­£åœ¨ä¿å­˜ä¸­...';
                return e.returnValue;
            }
        });
        
        // å®šæœŸæ£€æŸ¥ä¿å­˜é˜Ÿåˆ—
        setInterval(() => {
            if (saveQueue.length > 0 && !isSaving) {
                processSaveQueue();
            }
        }, 2000);
    </script>
    
</body>
</html>